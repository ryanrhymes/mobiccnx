.TH "sync/SyncActions.c" 3 "21 Aug 2012" "Version 0.6.1" "Content-Centric Networking in C" \" -*- nroff -*-
.ad l
.nh
.SH NAME
sync/SyncActions.c \- 
.PP
Part of CCNx Sync.  

.SH SYNOPSIS
.br
.PP
.SS "Defines"

.in +1c
.ti -1c
.RI "#define \fBM\fP   1000000"
.br
.ti -1c
.RI "#define \fBSYNC_UPDATE_VERSION\fP   (20120307)"
.br
.ti -1c
.RI "#define \fBStatsLine\fP(XXX)"
.br
.in -1c
.SS "Enumerations"

.in +1c
.ti -1c
.RI "enum \fBSyncCompareState\fP { \fBSyncCompare_init\fP, \fBSyncCompare_preload\fP, \fBSyncCompare_busy\fP, \fBSyncCompare_waiting\fP, \fBSyncCompare_done\fP, \fBSyncCompare_init\fP, \fBSyncCompare_preload\fP, \fBSyncCompare_busy\fP, \fBSyncCompare_waiting\fP, \fBSyncCompare_done\fP }"
.br
.ti -1c
.RI "enum \fBSyncUpdateState\fP { \fBSyncUpdate_init\fP, \fBSyncUpdate_inserted\fP, \fBSyncUpdate_busy\fP, \fBSyncUpdate_error\fP, \fBSyncUpdate_done\fP }"
.br
.in -1c
.SS "Functions"

.in +1c
.ti -1c
.RI "static int \fBHeartbeatAction\fP (struct ccn_schedule *sched, void *clienth, struct \fBccn_scheduled_event\fP *ev, int flags)"
.br
.ti -1c
.RI "static int \fBUpdateAction\fP (struct ccn_schedule *sched, void *clienth, struct \fBccn_scheduled_event\fP *ev, int flags)"
.br
.ti -1c
.RI "static int \fBCompareAction\fP (struct ccn_schedule *sched, void *clienth, struct \fBccn_scheduled_event\fP *ev, int flags)"
.br
.ti -1c
.RI "static int \fBshowCacheEntry\fP (struct \fBSyncRootStruct\fP *root, char *dst, int lim, char *prefix, struct \fBSyncHashCacheEntry\fP *ce)"
.br
.ti -1c
.RI "static void \fBshowCacheEntry1\fP (struct \fBSyncRootStruct\fP *root, char *here, char *msg, struct \fBSyncHashCacheEntry\fP *ce)"
.br
.ti -1c
.RI "static void \fBshowCacheEntry2\fP (struct \fBSyncRootStruct\fP *root, char *here, char *msg, struct \fBSyncHashCacheEntry\fP *ce1, struct \fBSyncHashCacheEntry\fP *ce2)"
.br
.ti -1c
.RI "static struct \fBSyncActionData\fP * \fBnewActionData\fP (enum \fBSyncRegisterActionKind\fP kind)"
.br
.ti -1c
.RI "static void \fBlinkActionData\fP (struct \fBSyncRootStruct\fP *root, struct \fBSyncActionData\fP *data)"
.br
.ti -1c
.RI "static void \fBdelinkActionData\fP (struct \fBSyncActionData\fP *data)"
.br
.ti -1c
.RI "static int \fBmoveActionData\fP (struct \fBSyncActionData\fP *data, enum \fBSyncActionState\fP dstState)"
.br
.ti -1c
.RI "static struct \fBSyncActionData\fP * \fBdestroyActionData\fP (struct \fBSyncActionData\fP *data)"
.br
.ti -1c
.RI "static char * \fBgetCmdStr\fP (enum \fBSyncRegisterActionKind\fP kind)"
.br
.ti -1c
.RI "static char * \fBgetKindStr\fP (enum \fBSyncRegisterActionKind\fP kind)"
.br
.ti -1c
.RI "static void \fBsetCovered\fP (struct \fBSyncHashCacheEntry\fP *ce)"
.br
.ti -1c
.RI "static int \fBisCovered\fP (struct \fBSyncHashCacheEntry\fP *ce)"
.br
.ti -1c
.RI "static int \fBcompareHash\fP (struct \fBccn_charbuf\fP *hashX, struct \fBccn_charbuf\fP *hashY)"
.br
.ti -1c
.RI "static struct \fBSyncNameAccum\fP * \fBsortNames\fP (struct \fBSyncRootStruct\fP *root, struct \fBSyncNameAccum\fP *src)"
.br
.ti -1c
.RI "static int \fBreportExclude\fP (struct \fBSyncRootStruct\fP *root, struct \fBccn_buf_decoder\fP *d)"
.br
.ti -1c
.RI "static struct \fBccn_charbuf\fP * \fBformatStats\fP (struct \fBSyncRootStruct\fP *root, struct \fBccn_charbuf\fP *cb)"
.br
.ti -1c
.RI "static struct \fBSyncNameAccum\fP * \fBexclusionsFromHashList\fP (struct \fBSyncRootStruct\fP *root, struct \fBSyncNameAccum\fP *acc, struct \fBSyncHashInfoList\fP *list)"
.br
.ti -1c
.RI "static struct \fBccn_charbuf\fP * \fBconstructCommandPrefix\fP (struct \fBSyncRootStruct\fP *root, enum \fBSyncRegisterActionKind\fP kind)"
.br
.ti -1c
.RI "static int \fBextractDeltas\fP (struct \fBSyncRootStruct\fP *root, struct \fBccn_upcall_info\fP *info)"
.br
.ti -1c
.RI "static struct \fBSyncNodeComposite\fP * \fBextractNode\fP (struct \fBSyncRootStruct\fP *root, struct \fBccn_upcall_info\fP *info)"
.br
.ti -1c
.RI "static int \fBnoteHash\fP (struct \fBSyncRootStruct\fP *root, struct \fBSyncHashCacheEntry\fP *ce, int add, int remote)"
.br
.ti -1c
.RI "static struct \fBSyncHashInfoList\fP * \fBchooseRemoteHash\fP (struct \fBSyncRootStruct\fP *root)"
.br
.ti -1c
.RI "static int \fBfauxError\fP (struct \fBSyncBaseStruct\fP *base)"
.br
.ti -1c
.RI "static void \fBdestroyCompareData\fP (struct SyncCompareData *data)"
.br
.ti -1c
.RI "static void \fBabortCompare\fP (struct SyncCompareData *data, char *why)"
.br
.ti -1c
.RI "static int \fBextractBuf\fP (struct \fBccn_charbuf\fP *cb, struct \fBSyncNodeComposite\fP *nc, struct \fBSyncNodeElem\fP *ne)"
.br
.ti -1c
.RI "static struct \fBSyncHashCacheEntry\fP * \fBensureRemoteEntry\fP (struct SyncCompareData *data, const unsigned char *xp, ssize_t xs)"
.br
.ti -1c
.RI "static struct \fBSyncHashCacheEntry\fP * \fBcacheEntryForElem\fP (struct SyncCompareData *data, struct \fBSyncNodeComposite\fP *nc, struct \fBSyncNodeElem\fP *ne, int remote)"
.br
.ti -1c
.RI "static int \fBcomparisonFailed\fP (struct SyncCompareData *data, char *why, int line)"
.br
.ti -1c
.RI "static int \fBaddNameFromCompare\fP (struct SyncCompareData *data)"
.br
.ti -1c
.RI "static int \fBdoPreload\fP (struct SyncCompareData *data)"
.br
.ti -1c
.RI "static int \fBdoComparison\fP (struct SyncCompareData *data)"
.br
.ti -1c
.RI "static int \fBfetchStablePoint\fP (struct \fBSyncBaseStruct\fP *base, \fBccnr_hwm\fP *ptr)"
.br
.ti -1c
.RI "static int \fBstoreStablePoint\fP (struct \fBSyncBaseStruct\fP *base, \fBccnr_hwm\fP point)"
.br
.ti -1c
.RI "static int \fBisRootStableEnough\fP (struct \fBSyncRootStruct\fP *root, \fBccnr_hwm\fP target)"
.br
.ti -1c
.RI "static void \fBpurgeOldEntries\fP (struct \fBSyncRootStruct\fP *root)"
.br
.ti -1c
.RI "static void \fBkickCompare\fP (struct SyncCompareData *scd, struct \fBSyncActionData\fP *action)"
.br
.ti -1c
.RI "static void \fBkickHeartBeat\fP (struct \fBSyncRootStruct\fP *root, int micros)"
.br
.ti -1c
.RI "static struct \fBSyncHashCacheEntry\fP * \fBnewNodeCommon\fP (struct \fBSyncRootStruct\fP *root, struct \fBSyncNodeAccum\fP *nodes, struct \fBSyncNodeComposite\fP *nc)"
.br
.ti -1c
.RI "static struct \fBSyncHashCacheEntry\fP * \fBnodeFromNodes\fP (struct \fBSyncRootStruct\fP *root, struct \fBSyncNodeAccum\fP *na)"
.br
.ti -1c
.RI "int \fBSyncStartSliceEnum\fP (struct \fBSyncRootStruct\fP *root)"
.br
.RI "\fIstarts a slice enumeration for the root \fP"
.ti -1c
.RI "int \fBSyncStartHeartbeat\fP (struct \fBSyncBaseStruct\fP *base)"
.br
.RI "\fIstarts a periodic wakeup that maintains state across all roots \fP"
.ti -1c
.RI "enum \fBccn_upcall_res\fP \fBSyncRemoteFetchResponse\fP (struct \fBccn_closure\fP *selfp, enum \fBccn_upcall_kind\fP kind, struct \fBccn_upcall_info\fP *info)"
.br
.ti -1c
.RI "int \fBSyncStartNodeFetch\fP (struct \fBSyncRootStruct\fP *root, struct \fBSyncHashCacheEntry\fP *ce, struct SyncCompareData *comp)"
.br
.RI "\fIstarts a remote fetch of the given node, based on the hash comp may be NULL if this is not for a compare \fP"
.ti -1c
.RI "int \fBSyncStartContentFetch\fP (struct \fBSyncRootStruct\fP *root, struct \fBccn_charbuf\fP *name, struct SyncCompareData *comp)"
.br
.RI "\fIstarts a remote fetch of the given name comp may be NULL if this is not for a compare \fP"
.ti -1c
.RI "static struct \fBSyncActionData\fP * \fBSyncFindAction\fP (struct \fBSyncRootStruct\fP *root, enum \fBSyncRegisterActionKind\fP kind)"
.br
.ti -1c
.RI "int \fBSyncAddName\fP (struct \fBSyncBaseStruct\fP *base, struct \fBccn_charbuf\fP *name, \fBccnr_accession\fP item)"
.br
.RI "\fIAdds the given name to any applicable roots. \fP"
.ti -1c
.RI "static int \fBfindAndDeleteRoot\fP (struct \fBSyncBaseStruct\fP *base, char *here, const unsigned char *hp, ssize_t hs)"
.br
.ti -1c
.RI "int \fBSyncHandleSlice\fP (struct \fBSyncBaseStruct\fP *base, struct \fBccn_charbuf\fP *name)"
.br
.RI "\fICreates a new slice from a full name. \fP"
.ti -1c
.RI "static struct \fBSyncRootDeltas\fP * \fBNewDeltas\fP (struct \fBSyncRootStruct\fP *root)"
.br
.ti -1c
.RI "static struct \fBSyncRootDeltas\fP * \fBFreeDeltas\fP (struct \fBSyncRootDeltas\fP *deltas)"
.br
.ti -1c
.RI "static int \fBRemRootDeltas\fP (struct \fBSyncRootStruct\fP *root, struct \fBSyncRootDeltas\fP *deltas)"
.br
.ti -1c
.RI "static int \fBSendDeltasReply\fP (struct \fBSyncRootStruct\fP *root, struct \fBSyncRootDeltas\fP *deltas)"
.br
.ti -1c
.RI "static struct \fBSyncHashInfoList\fP * \fBscanRemoteSeen\fP (struct \fBSyncRootStruct\fP *root, struct \fBSyncHashCacheEntry\fP *ceR)"
.br
.ti -1c
.RI "static struct \fBSyncRootDeltas\fP * \fBCloseUpdateCoding\fP (struct SyncUpdateData *ud)"
.br
.ti -1c
.RI "static struct \fBSyncRootDeltas\fP * \fBscanDeltas\fP (struct \fBSyncRootStruct\fP *root, struct \fBSyncHashCacheEntry\fP *ceR)"
.br
.ti -1c
.RI "enum \fBccn_upcall_res\fP \fBSyncInterestArrived\fP (struct \fBccn_closure\fP *selfp, enum \fBccn_upcall_kind\fP kind, struct \fBccn_upcall_info\fP *info)"
.br
.ti -1c
.RI "static int \fBSyncRegisterInterest\fP (struct \fBSyncRootStruct\fP *root, enum \fBSyncRegisterActionKind\fP kind)"
.br
.ti -1c
.RI "int \fBSyncRegisterInterests\fP (struct \fBSyncRootStruct\fP *root)"
.br
.RI "\fIregisters interests associated with the given root these include C1.S.RA (Root Advise) and C1.S.NF (Node Fetch) interests additional interests may be registered as the protocol evolves \fP"
.ti -1c
.RI "enum \fBccn_upcall_res\fP \fBSyncRootAdviseResponse\fP (struct \fBccn_closure\fP *selfp, enum \fBccn_upcall_kind\fP kind, struct \fBccn_upcall_info\fP *info)"
.br
.ti -1c
.RI "int \fBSyncSendRootAdviseInterest\fP (struct \fBSyncRootStruct\fP *root)"
.br
.RI "\fIsend a root advise request for the given root only one at a time may be outstanding \fP"
.ti -1c
.RI "static int \fBMakeNodeFromNames\fP (struct SyncUpdateData *ud, int split)"
.br
.ti -1c
.RI "static int \fBTryNodeSplit\fP (struct SyncUpdateData *ud)"
.br
.ti -1c
.RI "static int \fBAddUpdateName\fP (struct SyncUpdateData *ud, struct \fBccn_charbuf\fP *name, int isNew)"
.br
.ti -1c
.RI "static int \fBSyncTreeMergeNames\fP (struct \fBSyncTreeWorkerHead\fP *head, struct SyncUpdateData *ud)"
.br
.ti -1c
.RI "static struct SyncUpdateData * \fBFreeUpdateData\fP (struct SyncUpdateData *ud)"
.br
.ti -1c
.RI "int \fBSyncUpdateRoot\fP (struct \fBSyncRootStruct\fP *root)"
.br
.RI "\fIupdates the root with the current root->namesToAdd \fP"
.ti -1c
.RI "int \fBSyncStartCompareAction\fP (struct \fBSyncRootStruct\fP *root, struct \fBccn_charbuf\fP *hashR)"
.br
.RI "\fIinitiates a compare action with the given remote hash \fP"
.in -1c
.SS "Variables"

.in +1c
.ti -1c
.RI "static int \fBuseCompExcl\fP = 1"
.br
.ti -1c
.RI "static int \fBshowHighLevel\fP = 1"
.br
.ti -1c
.RI "static int \fBnDeltasLimit\fP = 4"
.br
.ti -1c
.RI "static int \fBcachePurgeTrigger\fP = 60"
.br
.ti -1c
.RI "static int \fBcacheCleanBatch\fP = 16"
.br
.ti -1c
.RI "static int \fBcacheCleanDelta\fP = 8"
.br
.ti -1c
.RI "static int \fBadviseNeedReset\fP = 1"
.br
.ti -1c
.RI "static int \fBupdateStallDelta\fP = 15"
.br
.ti -1c
.RI "static int \fBupdateNeedDelta\fP = 6"
.br
.ti -1c
.RI "static int \fBshortDelayMicros\fP = 1000"
.br
.ti -1c
.RI "static int \fBcompareAssumeBad\fP = 20"
.br
.ti -1c
.RI "static int \fBnodeSplitTrigger\fP = 4000"
.br
.ti -1c
.RI "static int \fBexclusionLimit\fP = 600"
.br
.ti -1c
.RI "static int \fBexclusionTrig\fP = 5"
.br
.ti -1c
.RI "static int \fBstableTimeTrig\fP = 10"
.br
.ti -1c
.RI "static int \fBhashSplitTrigger\fP = 17"
.br
.ti -1c
.RI "static int \fBnamesYieldInc\fP = 100"
.br
.ti -1c
.RI "static int \fBnamesYieldMicros\fP = 20*1000"
.br
.ti -1c
.RI "static char * \fBsyncStableSuffix\fP = 'SyncStable'"
.br
.in -1c
.SH "Detailed Description"
.PP 
Part of CCNx Sync. 

This library is free software; you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License version 2.1 as published by the Free Software Foundation. This library is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details. You should have received a copy of the GNU Lesser General Public License along with this library; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA. 
.PP
Definition in file \fBSyncActions.c\fP.
.SH "Define Documentation"
.PP 
.SS "#define M   1000000"
.PP
Definition at line 42 of file SyncActions.c.
.PP
Referenced by chooseRemoteHash(), exclusionsFromHashList(), formatStats(), GetCurrentTime(), GetCurrentTimeUSecs(), HeartbeatAction(), MilliSleep(), purgeOldEntries(), and SyncCurrentTime().
.SS "#define StatsLine(XXX)"\fBValue:\fP
.PP
.nf
if (stats->XXX) \
pos += snprintf(s+pos, lim-pos, ', %s %ju', #XXX, (uintmax_t) stats->XXX);
.fi
.PP
Definition at line 436 of file SyncActions.c.
.PP
Referenced by formatStats().
.SS "#define SYNC_UPDATE_VERSION   (20120307)"
.PP
Definition at line 65 of file SyncActions.c.
.PP
Referenced by extractDeltas(), and NewDeltas().
.SH "Enumeration Type Documentation"
.PP 
.SS "enum \fBSyncCompareState\fP"
.PP
\fBEnumerator: \fP
.in +1c
.TP
\fB\fISyncCompare_init \fP\fP
.TP
\fB\fISyncCompare_preload \fP\fP
.TP
\fB\fISyncCompare_busy \fP\fP
.TP
\fB\fISyncCompare_waiting \fP\fP
.TP
\fB\fISyncCompare_done \fP\fP
.TP
\fB\fISyncCompare_init \fP\fP
.TP
\fB\fISyncCompare_preload \fP\fP
.TP
\fB\fISyncCompare_busy \fP\fP
.TP
\fB\fISyncCompare_waiting \fP\fP
.TP
\fB\fISyncCompare_done \fP\fP

.PP
Definition at line 67 of file SyncActions.c.
.SS "enum \fBSyncUpdateState\fP"
.PP
\fBEnumerator: \fP
.in +1c
.TP
\fB\fISyncUpdate_init \fP\fP
.TP
\fB\fISyncUpdate_inserted \fP\fP
.TP
\fB\fISyncUpdate_busy \fP\fP
.TP
\fB\fISyncUpdate_error \fP\fP
.TP
\fB\fISyncUpdate_done \fP\fP

.PP
Definition at line 102 of file SyncActions.c.
.SH "Function Documentation"
.PP 
.SS "static void abortCompare (struct SyncCompareData * data, char * why)\fC [static]\fP"
.PP
Definition at line 836 of file SyncActions.c.
.PP
Referenced by CompareAction(), and HeartbeatAction().
.SS "static int addNameFromCompare (struct SyncCompareData * data)\fC [static]\fP"
.PP
Definition at line 953 of file SyncActions.c.
.PP
Referenced by doComparison().
.SS "static int AddUpdateName (struct SyncUpdateData * ud, struct \fBccn_charbuf\fP * name, int isNew)\fC [static]\fP"
.PP
Definition at line 3446 of file SyncActions.c.
.PP
Referenced by SyncTreeMergeNames().
.SS "static struct \fBSyncHashCacheEntry\fP* cacheEntryForElem (struct SyncCompareData * data, struct \fBSyncNodeComposite\fP * nc, struct \fBSyncNodeElem\fP * ne, int remote)\fC [static, read]\fP"
.PP
Definition at line 906 of file SyncActions.c.
.PP
Referenced by doComparison(), and doPreload().
.SS "static struct \fBSyncHashInfoList\fP* chooseRemoteHash (struct \fBSyncRootStruct\fP * root)\fC [static, read]\fP"
.PP
Definition at line 759 of file SyncActions.c.
.PP
Referenced by HeartbeatAction().
.SS "static struct \fBSyncRootDeltas\fP* CloseUpdateCoding (struct SyncUpdateData * ud)\fC [static, read]\fP"
.PP
Definition at line 2645 of file SyncActions.c.
.PP
Referenced by UpdateAction().
.SS "static int CompareAction (struct ccn_schedule * sched, void * clienth, struct \fBccn_scheduled_event\fP * ev, int flags)\fC [static]\fP"
.PP
Definition at line 1386 of file SyncActions.c.
.PP
Referenced by kickCompare().
.SS "static int compareHash (struct \fBccn_charbuf\fP * hashX, struct \fBccn_charbuf\fP * hashY)\fC [static]\fP"
.PP
Definition at line 357 of file SyncActions.c.
.PP
Referenced by abortCompare(), and SyncStartNodeFetch().
.SS "static int comparisonFailed (struct SyncCompareData * data, char * why, int line)\fC [static]\fP"
.PP
Definition at line 946 of file SyncActions.c.
.PP
Referenced by doComparison().
.SS "static struct \fBccn_charbuf\fP* constructCommandPrefix (struct \fBSyncRootStruct\fP * root, enum \fBSyncRegisterActionKind\fP kind)\fC [static, read]\fP"
.PP
Definition at line 588 of file SyncActions.c.
.PP
Referenced by SendDeltasReply(), SyncRegisterInterest(), SyncSendRootAdviseInterest(), and SyncStartNodeFetch().
.SS "static void delinkActionData (struct \fBSyncActionData\fP * data)\fC [static]\fP"
.PP
Definition at line 205 of file SyncActions.c.
.PP
Referenced by destroyActionData(), and moveActionData().
.SS "static struct \fBSyncActionData\fP* destroyActionData (struct \fBSyncActionData\fP * data)\fC [static, read]\fP"
.PP
Definition at line 276 of file SyncActions.c.
.PP
Referenced by CompareAction(), destroyCompareData(), doPreload(), SyncInterestArrived(), SyncRegisterInterest(), SyncRemoteFetchResponse(), SyncRootAdviseResponse(), SyncSendRootAdviseInterest(), SyncStartContentFetch(), and SyncStartNodeFetch().
.SS "static void destroyCompareData (struct SyncCompareData * data)\fC [static]\fP"
.PP
Definition at line 803 of file SyncActions.c.
.PP
Referenced by abortCompare(), and CompareAction().
.SS "static int doComparison (struct SyncCompareData * data)\fC [static]\fP"
.PP
Definition at line 1049 of file SyncActions.c.
.PP
Referenced by CompareAction().
.SS "static int doPreload (struct SyncCompareData * data)\fC [static]\fP"
.PP
Definition at line 978 of file SyncActions.c.
.PP
Referenced by CompareAction().
.SS "static struct \fBSyncHashCacheEntry\fP* ensureRemoteEntry (struct SyncCompareData * data, const unsigned char * xp, ssize_t xs)\fC [static, read]\fP"
.PP
Definition at line 890 of file SyncActions.c.
.PP
Referenced by cacheEntryForElem().
.SS "static struct \fBSyncNameAccum\fP* exclusionsFromHashList (struct \fBSyncRootStruct\fP * root, struct \fBSyncNameAccum\fP * acc, struct \fBSyncHashInfoList\fP * list)\fC [static, read]\fP"
.PP
Definition at line 552 of file SyncActions.c.
.PP
Referenced by SyncSendRootAdviseInterest().
.SS "static int extractBuf (struct \fBccn_charbuf\fP * cb, struct \fBSyncNodeComposite\fP * nc, struct \fBSyncNodeElem\fP * ne)\fC [static]\fP"
.PP
Definition at line 881 of file SyncActions.c.
.PP
Referenced by doComparison(), and SyncTreeMergeNames().
.SS "static int extractDeltas (struct \fBSyncRootStruct\fP * root, struct \fBccn_upcall_info\fP * info)\fC [static]\fP"
.PP
Definition at line 611 of file SyncActions.c.
.PP
Referenced by SyncRootAdviseResponse().
.SS "static struct \fBSyncNodeComposite\fP* extractNode (struct \fBSyncRootStruct\fP * root, struct \fBccn_upcall_info\fP * info)\fC [static, read]\fP"
.PP
Definition at line 658 of file SyncActions.c.
.PP
Referenced by SyncRemoteFetchResponse(), and SyncRootAdviseResponse().
.SS "static int fauxError (struct \fBSyncBaseStruct\fP * base)\fC [static]\fP"
.PP
Definition at line 786 of file SyncActions.c.
.PP
Referenced by SyncRemoteFetchResponse(), and SyncRootAdviseResponse().
.SS "static int fetchStablePoint (struct \fBSyncBaseStruct\fP * base, \fBccnr_hwm\fP * ptr)\fC [static]\fP"
.PP
Definition at line 1258 of file SyncActions.c.
.PP
Referenced by SyncStartHeartbeat().
.SS "static int findAndDeleteRoot (struct \fBSyncBaseStruct\fP * base, char * here, const unsigned char * hp, ssize_t hs)\fC [static]\fP"
.PP
Definition at line 2342 of file SyncActions.c.
.PP
Referenced by SyncHandleSlice().
.SS "static struct \fBccn_charbuf\fP* formatStats (struct \fBSyncRootStruct\fP * root, struct \fBccn_charbuf\fP * cb)\fC [static, read]\fP"
.PP
Definition at line 441 of file SyncActions.c.
.PP
Referenced by CompareAction(), SyncInterestArrived(), and UpdateAction().
.SS "static struct \fBSyncRootDeltas\fP* FreeDeltas (struct \fBSyncRootDeltas\fP * deltas)\fC [static, read]\fP"
.PP
Definition at line 2523 of file SyncActions.c.
.PP
Referenced by CloseUpdateCoding(), FreeUpdateData(), RemRootDeltas(), and UpdateAction().
.SS "static struct SyncUpdateData* FreeUpdateData (struct SyncUpdateData * ud)\fC [static, read]\fP"
.PP
Definition at line 3617 of file SyncActions.c.
.PP
Referenced by SyncUpdateRoot(), and UpdateAction().
.SS "static char* getCmdStr (enum \fBSyncRegisterActionKind\fP kind)\fC [static]\fP"
.PP
Definition at line 293 of file SyncActions.c.
.PP
Referenced by constructCommandPrefix().
.SS "static char* getKindStr (enum \fBSyncRegisterActionKind\fP kind)\fC [static]\fP"
.PP
Definition at line 309 of file SyncActions.c.
.PP
Referenced by SyncInterestArrived(), and SyncRegisterInterest().
.SS "static int HeartbeatAction (struct ccn_schedule * sched, void * clienth, struct \fBccn_scheduled_event\fP * ev, int flags)\fC [static]\fP"
.PP
Definition at line 1724 of file SyncActions.c.
.PP
Referenced by kickHeartBeat(), and SyncStartHeartbeat().
.SS "static int isCovered (struct \fBSyncHashCacheEntry\fP * ce)\fC [static]\fP"
.PP
Definition at line 346 of file SyncActions.c.
.PP
Referenced by doComparison(), doPreload(), exclusionsFromHashList(), noteHash(), SyncInterestArrived(), SyncRemoteFetchResponse(), and SyncRootAdviseResponse().
.SS "static int isRootStableEnough (struct \fBSyncRootStruct\fP * root, \fBccnr_hwm\fP target)\fC [static]\fP"
.PP
Definition at line 1338 of file SyncActions.c.
.PP
Referenced by HeartbeatAction().
.SS "static void kickCompare (struct SyncCompareData * scd, struct \fBSyncActionData\fP * action)\fC [static]\fP"
.PP
Definition at line 1536 of file SyncActions.c.
.PP
Referenced by SyncRemoteFetchResponse(), and SyncStartCompareAction().
.SS "static void kickHeartBeat (struct \fBSyncRootStruct\fP * root, int micros)\fC [static]\fP"
.PP
Definition at line 1550 of file SyncActions.c.
.PP
Referenced by UpdateAction().
.SS "static void linkActionData (struct \fBSyncRootStruct\fP * root, struct \fBSyncActionData\fP * data)\fC [static]\fP"
.PP
Definition at line 195 of file SyncActions.c.
.PP
Referenced by SyncRegisterInterest(), SyncSendRootAdviseInterest(), SyncStartContentFetch(), and SyncStartNodeFetch().
.SS "static int MakeNodeFromNames (struct SyncUpdateData * ud, int split)\fC [static]\fP"
.PP
Definition at line 3292 of file SyncActions.c.
.PP
Referenced by TryNodeSplit(), and UpdateAction().
.SS "static int moveActionData (struct \fBSyncActionData\fP * data, enum \fBSyncActionState\fP dstState)\fC [static]\fP"
.PP
Definition at line 250 of file SyncActions.c.
.PP
Referenced by SyncRemoteFetchResponse().
.SS "static struct \fBSyncActionData\fP* newActionData (enum \fBSyncRegisterActionKind\fP kind)\fC [static, read]\fP"
.PP
Definition at line 186 of file SyncActions.c.
.PP
Referenced by SyncRegisterInterest(), SyncSendRootAdviseInterest(), SyncStartContentFetch(), and SyncStartNodeFetch().
.SS "static struct \fBSyncRootDeltas\fP* NewDeltas (struct \fBSyncRootStruct\fP * root)\fC [static, read]\fP"
.PP
Definition at line 2509 of file SyncActions.c.
.PP
Referenced by SyncUpdateRoot().
.SS "static struct \fBSyncHashCacheEntry\fP* newNodeCommon (struct \fBSyncRootStruct\fP * root, struct \fBSyncNodeAccum\fP * nodes, struct \fBSyncNodeComposite\fP * nc)\fC [static, read]\fP"
.PP
Definition at line 1564 of file SyncActions.c.
.PP
Referenced by MakeNodeFromNames(), and nodeFromNodes().
.SS "static struct \fBSyncHashCacheEntry\fP* nodeFromNodes (struct \fBSyncRootStruct\fP * root, struct \fBSyncNodeAccum\fP * na)\fC [static, read]\fP"
.PP
Definition at line 1630 of file SyncActions.c.
.PP
Referenced by UpdateAction().
.SS "static int noteHash (struct \fBSyncRootStruct\fP * root, struct \fBSyncHashCacheEntry\fP * ce, int add, int remote)\fC [static]\fP"
.PP
Definition at line 691 of file SyncActions.c.
.PP
Referenced by SyncInterestArrived(), SyncRootAdviseResponse(), and UpdateAction().
.SS "static void purgeOldEntries (struct \fBSyncRootStruct\fP * root)\fC [static]\fP"
.PP
Definition at line 1347 of file SyncActions.c.
.PP
Referenced by SyncInterestArrived().
.SS "static int RemRootDeltas (struct \fBSyncRootStruct\fP * root, struct \fBSyncRootDeltas\fP * deltas)\fC [static]\fP"
.PP
Definition at line 2537 of file SyncActions.c.
.PP
Referenced by SendDeltasReply().
.SS "static int reportExclude (struct \fBSyncRootStruct\fP * root, struct \fBccn_buf_decoder\fP * d)\fC [static]\fP"
.PP
Definition at line 408 of file SyncActions.c.
.PP
Referenced by SyncInterestArrived().
.SS "static struct \fBSyncRootDeltas\fP* scanDeltas (struct \fBSyncRootStruct\fP * root, struct \fBSyncHashCacheEntry\fP * ceR)\fC [static, read]\fP"
.PP
Definition at line 2677 of file SyncActions.c.
.PP
Referenced by SyncInterestArrived().
.SS "static struct \fBSyncHashInfoList\fP* scanRemoteSeen (struct \fBSyncRootStruct\fP * root, struct \fBSyncHashCacheEntry\fP * ceR)\fC [static, read]\fP"
.PP
Definition at line 2632 of file SyncActions.c.
.PP
Referenced by UpdateAction().
.SS "static int SendDeltasReply (struct \fBSyncRootStruct\fP * root, struct \fBSyncRootDeltas\fP * deltas)\fC [static]\fP"
.PP
Definition at line 2565 of file SyncActions.c.
.PP
Referenced by SyncInterestArrived(), and UpdateAction().
.SS "static void setCovered (struct \fBSyncHashCacheEntry\fP * ce)\fC [static]\fP"
.PP
Definition at line 329 of file SyncActions.c.
.PP
Referenced by doComparison(), ensureRemoteEntry(), isCovered(), newNodeCommon(), and noteHash().
.SS "static int showCacheEntry (struct \fBSyncRootStruct\fP * root, char * dst, int lim, char * prefix, struct \fBSyncHashCacheEntry\fP * ce)\fC [static]\fP"
.PP
Definition at line 160 of file SyncActions.c.
.PP
Referenced by showCacheEntry1(), and showCacheEntry2().
.SS "static void showCacheEntry1 (struct \fBSyncRootStruct\fP * root, char * here, char * msg, struct \fBSyncHashCacheEntry\fP * ce)\fC [static]\fP"
.PP
Definition at line 169 of file SyncActions.c.
.PP
Referenced by SyncInterestArrived(), SyncRemoteFetchResponse(), SyncSendRootAdviseInterest(), and SyncStartNodeFetch().
.SS "static void showCacheEntry2 (struct \fBSyncRootStruct\fP * root, char * here, char * msg, struct \fBSyncHashCacheEntry\fP * ce1, struct \fBSyncHashCacheEntry\fP * ce2)\fC [static]\fP"
.PP
Definition at line 177 of file SyncActions.c.
.PP
Referenced by SendDeltasReply(), SyncInterestArrived(), SyncRootAdviseResponse(), and UpdateAction().
.SS "static struct \fBSyncNameAccum\fP* sortNames (struct \fBSyncRootStruct\fP * root, struct \fBSyncNameAccum\fP * src)\fC [static, read]\fP"
.PP
Definition at line 371 of file SyncActions.c.
.PP
Referenced by exclusionsFromHashList().
.SS "static int storeStablePoint (struct \fBSyncBaseStruct\fP * base, \fBccnr_hwm\fP point)\fC [static]\fP"
.PP
Definition at line 1310 of file SyncActions.c.
.PP
Referenced by HeartbeatAction().
.SS "int SyncAddName (struct \fBSyncBaseStruct\fP * base, struct \fBccn_charbuf\fP * name, \fBccnr_accession\fP item)"
.PP
Adds the given name to any applicable roots. Use item == 0 to ignore accession number. 
.PP
\fBReturns:\fP
.RS 4
< 0 for failure, number of additions to roots for success. 
.RE
.PP

.PP
Definition at line 2293 of file SyncActions.c.
.SS "static struct \fBSyncActionData\fP* SyncFindAction (struct \fBSyncRootStruct\fP * root, enum \fBSyncRegisterActionKind\fP kind)\fC [static, read]\fP"
.PP
Definition at line 2283 of file SyncActions.c.
.PP
Referenced by SyncSendRootAdviseInterest().
.SS "int SyncHandleSlice (struct \fBSyncBaseStruct\fP * base, struct \fBccn_charbuf\fP * name)"
.PP
Creates a new slice from a full name. The name must start with base->priv->sliceCmdPrefix. 
.PP
\fBReturns:\fP
.RS 4
< 0 if an error occurred, otherwise the new root number. 
.RE
.PP

.PP
Definition at line 2388 of file SyncActions.c.
.SS "enum \fBccn_upcall_res\fP SyncInterestArrived (struct \fBccn_closure\fP * selfp, enum \fBccn_upcall_kind\fP kind, struct \fBccn_upcall_info\fP * info)"
.PP
Definition at line 2687 of file SyncActions.c.
.SS "static int SyncRegisterInterest (struct \fBSyncRootStruct\fP * root, enum \fBSyncRegisterActionKind\fP kind)\fC [static]\fP"
.PP
Definition at line 2974 of file SyncActions.c.
.PP
Referenced by SyncRegisterInterests().
.SS "int SyncRegisterInterests (struct \fBSyncRootStruct\fP * root)"
.PP
registers interests associated with the given root these include C1.S.RA (Root Advise) and C1.S.NF (Node Fetch) interests additional interests may be registered as the protocol evolves \fBReturns:\fP
.RS 4
< 0 for error, >= 0 for success 
.RE
.PP

.PP
Definition at line 3011 of file SyncActions.c.
.SS "enum \fBccn_upcall_res\fP SyncRemoteFetchResponse (struct \fBccn_closure\fP * selfp, enum \fBccn_upcall_kind\fP kind, struct \fBccn_upcall_info\fP * info)"
.PP
Definition at line 1959 of file SyncActions.c.
.SS "enum \fBccn_upcall_res\fP SyncRootAdviseResponse (struct \fBccn_closure\fP * selfp, enum \fBccn_upcall_kind\fP kind, struct \fBccn_upcall_info\fP * info)"
.PP
Definition at line 3065 of file SyncActions.c.
.PP
Referenced by SyncSendRootAdviseInterest().
.SS "int SyncSendRootAdviseInterest (struct \fBSyncRootStruct\fP * root)"
.PP
send a root advise request for the given root only one at a time may be outstanding \fBReturns:\fP
.RS 4
< 0 for error, >= 0 for OK 
.RE
.PP

.PP
Definition at line 3218 of file SyncActions.c.
.PP
Referenced by HeartbeatAction(), and UpdateAction().
.SS "int SyncStartCompareAction (struct \fBSyncRootStruct\fP * root, struct \fBccn_charbuf\fP * hashR)"
.PP
initiates a compare action with the given remote hash \fBReturns:\fP
.RS 4
< 0 for error, >= 0 for OK 
.RE
.PP

.PP
Definition at line 3921 of file SyncActions.c.
.SS "int SyncStartContentFetch (struct \fBSyncRootStruct\fP * root, struct \fBccn_charbuf\fP * name, struct SyncCompareData * comp)"
.PP
starts a remote fetch of the given name comp may be NULL if this is not for a compare \fBReturns:\fP
.RS 4
< 0 for error, >= 0 for success 
.RE
.PP

.PP
Definition at line 2225 of file SyncActions.c.
.PP
Referenced by CompareAction().
.SS "int SyncStartHeartbeat (struct \fBSyncBaseStruct\fP * base)"
.PP
starts a periodic wakeup that maintains state across all roots \fBReturns:\fP
.RS 4
< 0 for error, >= 0 for success 
.RE
.PP

.PP
Definition at line 1904 of file SyncActions.c.
.SS "int SyncStartNodeFetch (struct \fBSyncRootStruct\fP * root, struct \fBSyncHashCacheEntry\fP * ce, struct SyncCompareData * comp)"
.PP
starts a remote fetch of the given node, based on the hash comp may be NULL if this is not for a compare \fBReturns:\fP
.RS 4
< 0 for error, >= 0 for success 
.RE
.PP

.PP
Definition at line 2146 of file SyncActions.c.
.SS "int SyncStartSliceEnum (struct \fBSyncRootStruct\fP * root)"
.PP
starts a slice enumeration for the root \fBReturns:\fP
.RS 4
< 0 for error, 0 if some enumeration is busy, 1 for success 
.RE
.PP

.PP
Definition at line 1693 of file SyncActions.c.
.SS "static int SyncTreeMergeNames (struct \fBSyncTreeWorkerHead\fP * head, struct SyncUpdateData * ud)\fC [static]\fP"
.PP
Definition at line 3486 of file SyncActions.c.
.PP
Referenced by UpdateAction().
.SS "int SyncUpdateRoot (struct \fBSyncRootStruct\fP * root)"
.PP
updates the root with the current root->namesToAdd \fBReturns:\fP
.RS 4
< 0 for error, >= 0 for OK 
.RE
.PP

.PP
Definition at line 3873 of file SyncActions.c.
.PP
Referenced by HeartbeatAction(), and testReadBuilder().
.SS "static int TryNodeSplit (struct SyncUpdateData * ud)\fC [static]\fP"
.PP
Definition at line 3366 of file SyncActions.c.
.PP
Referenced by AddUpdateName().
.SS "static int UpdateAction (struct ccn_schedule * sched, void * clienth, struct \fBccn_scheduled_event\fP * ev, int flags)\fC [static]\fP"
.PP
Definition at line 3628 of file SyncActions.c.
.PP
Referenced by SyncUpdateRoot().
.SH "Variable Documentation"
.PP 
.SS "int \fBadviseNeedReset\fP = 1\fC [static]\fP"
.PP
Definition at line 51 of file SyncActions.c.
.PP
Referenced by HeartbeatAction(), SyncInterestArrived(), SyncRegisterInterests(), and UpdateAction().
.SS "int \fBcacheCleanBatch\fP = 16\fC [static]\fP"
.PP
Definition at line 49 of file SyncActions.c.
.PP
Referenced by HeartbeatAction().
.SS "int \fBcacheCleanDelta\fP = 8\fC [static]\fP"
.PP
Definition at line 50 of file SyncActions.c.
.PP
Referenced by HeartbeatAction().
.SS "int \fBcachePurgeTrigger\fP = 60\fC [static]\fP"
.PP
Definition at line 48 of file SyncActions.c.
.PP
Referenced by purgeOldEntries().
.SS "int \fBcompareAssumeBad\fP = 20\fC [static]\fP"
.PP
Definition at line 55 of file SyncActions.c.
.PP
Referenced by HeartbeatAction().
.SS "int \fBexclusionLimit\fP = 600\fC [static]\fP"
.PP
Definition at line 57 of file SyncActions.c.
.PP
Referenced by exclusionsFromHashList().
.SS "int \fBexclusionTrig\fP = 5\fC [static]\fP"
.PP
Definition at line 58 of file SyncActions.c.
.PP
Referenced by exclusionsFromHashList().
.SS "int \fBhashSplitTrigger\fP = 17\fC [static]\fP"
.PP
Definition at line 60 of file SyncActions.c.
.PP
Referenced by TryNodeSplit().
.SS "int \fBnamesYieldInc\fP = 100\fC [static]\fP"
.PP
Definition at line 61 of file SyncActions.c.
.PP
Referenced by SyncTreeMergeNames(), and UpdateAction().
.SS "int \fBnamesYieldMicros\fP = 20*1000\fC [static]\fP"
.PP
Definition at line 62 of file SyncActions.c.
.PP
Referenced by SyncTreeMergeNames(), and UpdateAction().
.SS "int \fBnDeltasLimit\fP = 4\fC [static]\fP"
.PP
Definition at line 47 of file SyncActions.c.
.PP
Referenced by SendDeltasReply().
.SS "int \fBnodeSplitTrigger\fP = 4000\fC [static]\fP"
.PP
Definition at line 56 of file SyncActions.c.
.PP
Referenced by AddUpdateName(), newNodeCommon(), nodeFromNodes(), and TryNodeSplit().
.SS "int \fBshortDelayMicros\fP = 1000\fC [static]\fP"
.PP
Definition at line 54 of file SyncActions.c.
.PP
Referenced by CompareAction(), HeartbeatAction(), kickCompare(), and UpdateAction().
.SS "int \fBshowHighLevel\fP = 1\fC [static]\fP"
.PP
Definition at line 46 of file SyncActions.c.
.PP
Referenced by SendDeltasReply(), SyncInterestArrived(), SyncRemoteFetchResponse(), SyncRootAdviseResponse(), SyncSendRootAdviseInterest(), SyncStartNodeFetch(), and UpdateAction().
.SS "int \fBstableTimeTrig\fP = 10\fC [static]\fP"
.PP
Definition at line 59 of file SyncActions.c.
.PP
Referenced by HeartbeatAction().
.SS "char* \fBsyncStableSuffix\fP = 'SyncStable'\fC [static]\fP"
.PP
Definition at line 63 of file SyncActions.c.
.PP
Referenced by fetchStablePoint(), and storeStablePoint().
.SS "int \fBupdateNeedDelta\fP = 6\fC [static]\fP"
.PP
Definition at line 53 of file SyncActions.c.
.PP
Referenced by HeartbeatAction().
.SS "int \fBupdateStallDelta\fP = 15\fC [static]\fP"
.PP
Definition at line 52 of file SyncActions.c.
.PP
Referenced by HeartbeatAction().
.SS "int \fBuseCompExcl\fP = 1\fC [static]\fP"
.PP
Definition at line 45 of file SyncActions.c.
.PP
Referenced by SyncInterestArrived().
.SH "Author"
.PP 
Generated automatically by Doxygen for Content-Centric Networking in C from the source code.
